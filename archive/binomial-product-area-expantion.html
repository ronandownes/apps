<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Binomial Expander (ax + b)(cx + d)</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    .row {
      margin-bottom: 10px;
    }
    label {
      margin-right: 5px;
    }
    input[type="number"] {
      width: 60px;
    }
    button {
      margin-right: 10px;
    }
    .box {
      display: inline-block;
      margin-top: 20px;
      border: 2px solid #333;
      border-radius: 4px;
      overflow: hidden;
    }
    .box-row {
      display: flex;
    }
    .cell {
      width: 110px;
      height: 60px;
      border-right: 1px solid #333;
      border-bottom: 1px solid #333;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      transition: opacity 0.3s;
    }
    .box-row:last-child .cell {
      border-bottom: none;
    }
    .box-row .cell:last-child {
      border-right: none;
    }
    .hidden-step {
      opacity: 0;
    }
    .visible-step {
      opacity: 1;
    }
    #expression, #final {
      margin-top: 15px;
      font-size: 20px;
    }
    #steps {
      margin-top: 15px;
    }
    .step-line {
      margin: 3px 0;
    }
  </style>
</head>
<body>
  <h1>(ax + b)(cx + d) Expander</h1>

  <!-- Inputs -->
  <div class="row">
    <label for="a">a:</label>
    <input id="a" type="number" value="2" min="1" max="99" />
    <label for="b">b:</label>
    <input id="b" type="number" value="3" min="-99" max="99" />
    <label for="c">c:</label>
    <input id="c" type="number" value="4" min="1" max="99" />
    <label for="d">d:</label>
    <input id="d" type="number" value="-5" min="-99" max="99" />
  </div>

  <div class="row">
    <button id="expandBtn">Expand</button>
    <button id="toggleStepsBtn">Show / Hide steps</button>
    <button id="randomBtn">Random</button>
  </div>

  <!-- Original expression -->
  <div id="expression"></div>

  <!-- 2x2 box -->
  <div class="box">
    <div class="box-row">
      <div id="cell1" class="cell hidden-step"></div>
      <div id="cell2" class="cell hidden-step"></div>
    </div>
    <div class="box-row">
      <div id="cell3" class="cell hidden-step"></div>
      <div id="cell4" class="cell hidden-step"></div>
    </div>
  </div>

  <!-- Algebraic steps -->
  <div id="steps"></div>

  <!-- Final result -->
  <div id="final"></div>

  <script>
    function signedTerm(coef, variable) {
      if (coef === 0) return "";
      const sign = coef > 0 ? " + " : " - ";
      const abs = Math.abs(coef);
      if (!variable) {
        return sign + abs;
      }
      // For x terms: 1x -> x
      if (abs === 1) return sign + variable;
      return sign + abs + variable;
    }

    function buildExpression(a, b, c, d) {
      const leftB = b >= 0 ? "+ " + b : "- " + Math.abs(b);
      const rightD = d >= 0 ? "+ " + d : "- " + Math.abs(d);
      return "(" + a + "x " + leftB + ")(" + c + "x " + rightD + ")";
    }

    function expand() {
      const a = parseInt(document.getElementById("a").value, 10);
      const b = parseInt(document.getElementById("b").value, 10);
      const c = parseInt(document.getElementById("c").value, 10);
      const d = parseInt(document.getElementById("d").value, 10);

      const ac = a * c;
      const ad = a * d;
      const bc = b * c;
      const bd = b * d;

      const expressionDiv = document.getElementById("expression");
      expressionDiv.textContent = buildExpression(a, b, c, d);

      // Fill box cells
      document.getElementById("cell1").textContent = ac + "x²";
      document.getElementById("cell2").textContent = ad + "x";
      document.getElementById("cell3").textContent = bc + "x";
      document.getElementById("cell4").textContent = bd;

      // Reset visibility
      ["cell1","cell2","cell3","cell4"].forEach(id => {
        const el = document.getElementById(id);
        el.classList.remove("visible-step");
        el.classList.add("hidden-step");
      });

      const stepsDiv = document.getElementById("steps");
      stepsDiv.innerHTML = "";

      const step1 = document.createElement("div");
      step1.className = "step-line";
      step1.textContent = "1. Multiply each term: "
        + a + "x·" + c + "x,  "
        + a + "x·" + d + ",  "
        + b + "·" + c + "x,  "
        + b + "·" + d;

      const step2 = document.createElement("div");
      step2.className = "step-line";
      step2.textContent = "2. Products: "
        + ac + "x²,  "
        + ad + "x,  "
        + bc + "x,  "
        + bd;

      const step3 = document.createElement("div");
      step3.className = "step-line";
      step3.textContent = "3. Combine x terms: "
        + "(" + ad + " + " + bc + ")x";

      stepsDiv.appendChild(step1);
      stepsDiv.appendChild(step2);
      stepsDiv.appendChild(step3);

      const finalDiv = document.getElementById("final");
      const middleCoef = ad + bc;

      let result = ac + "x²";
      result += signedTerm(middleCoef, "x");
      result += signedTerm(bd, "");

      finalDiv.textContent = "(ax + b)(cx + d) = " + result;
    }

    function toggleSteps() {
      ["cell1","cell2","cell3","cell4"].forEach(id => {
        const el = document.getElementById(id);
        if (el.classList.contains("hidden-step")) {
          el.classList.remove("hidden-step");
          el.classList.add("visible-step");
        } else {
          el.classList.remove("visible-step");
          el.classList.add("hidden-step");
        }
      });

      const steps = document.getElementById("steps");
      steps.style.display = (steps.style.display === "none" || steps.style.display === "") ?
        "block" : "none";
    }

    function randomCoeffs() {
      function randPos() {
        return Math.floor(Math.random() * 99) + 1;
      }
      function randInt() {
        return Math.floor(Math.random() * 199) - 99;
      }
      document.getElementById("a").value = randPos();
      document.getElementById("c").value = randPos();
      document.getElementById("b").value = randInt();
      document.getElementById("d").value = randInt();
      expand();
    }

    document.getElementById("expandBtn").addEventListener("click", expand);
    document.getElementById("toggleStepsBtn").addEventListener("click", toggleSteps);
    document.getElementById("randomBtn").addEventListener("click", randomCoeffs);

    // Initial example
    expand();
  </script>
</body>
</html>
