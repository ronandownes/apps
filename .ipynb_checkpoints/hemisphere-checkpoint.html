<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Hemisphere Calculator</title>

<style>
:root{--ink:#000;--line:#cfcfcf;--muted:#666;--blue:#2563eb;--red:#dc2626}
*{box-sizing:border-box}
body{margin:0;font-family:Segoe UI,Arial,sans-serif;background:#fff;color:var(--ink)}
.wrap{max-width:960px;margin:6px auto;padding:0 6px}
.card{border:1px solid var(--line);border-radius:10px;padding:12px}

.controls-row{display:flex;flex-wrap:wrap;gap:8px;align-items:start;margin-bottom:12px}
.block{border:1px solid var(--line);border-radius:8px;padding:8px}
.block h3{margin:0 0 4px;font-size:12px}

.shape-block{min-width:140px}
.shape-title{font-family:"Times New Roman",Times,serif;font-size:22px;font-weight:700}
.shape-sub{font-size:11px;color:var(--muted);margin-top:2px}

.radius-block{display:flex;align-items:center;gap:12px;padding:10px 16px}
.radius-block h3{margin:0;font-size:13px}
.value-input{width:90px;border:2px solid var(--blue);border-radius:6px;padding:8px 10px;font-size:22px;text-align:center;font-family:"Times New Roman",Times,serif;font-weight:bold}
.value-input:focus{outline:none;border-color:#000}
.radius-display{font-family:"Times New Roman",Times,serif;font-size:20px}

.dprow{display:flex;gap:4px}
.dprow button{flex:1;border:1px solid var(--line);border-radius:6px;background:#fff;font-size:12px;padding:6px 10px;cursor:pointer}
.dprow button.active{background:#000;color:#fff}

.btnrow{display:grid;grid-template-columns:repeat(5,1fr);gap:3px}
.btnrow button{border:1px solid var(--line);border-radius:5px;background:#fff;font-size:11px;padding:5px 3px;cursor:pointer}
.btnrow button.active{background:#000;color:#fff}

.reveal-btn{border:2px solid var(--line);border-radius:6px;background:#fff;font-size:14px;padding:10px 20px;cursor:pointer;font-weight:bold}
.reveal-btn:hover{background:#f5f5f5}

.main{display:grid;grid-template-columns:200px 1fr 1fr 1fr;gap:10px;align-items:start}

.diagram svg{width:100%;height:auto;display:block}
.formulas{font-family:"Times New Roman",Times,serif;margin-top:6px}
.formulas .f{font-size:14px;margin:3px 0}

.calc{border:1px solid var(--line);border-radius:8px;padding:10px;transition:filter 0.3s ease}
.calc.hidden{filter:blur(5px)}
.calc h2{margin:0 0 8px;font-size:14px;color:var(--muted)}
.line{font-family:"Times New Roman",Times,serif;font-size:16px;margin:4px 0}

.answer-container{margin:10px 0}
.answer-box{display:inline-block;border:2px solid #000;padding:8px 14px;font-family:"Times New Roman",Times,serif;font-size:20px}
.answer-box .label{font-style:italic}
.answer-box .dp-info{font-size:14px;color:var(--muted);margin-left:8px;font-family:Segoe UI,Arial,sans-serif}

.trunc-line{font-family:"Times New Roman",Times,serif;font-size:14px;margin:4px 0;color:var(--muted)}
.round-arrow{font-size:16px;font-weight:bold;margin-left:6px}
.round-up{color:#16a34a}
.round-down{color:#dc2626}

@media(max-width:800px){
  .main{grid-template-columns:1fr}
}
</style>
</head>

<body>
<div class="wrap">
<section class="card">

<div class="controls-row">
  <div class="block shape-block">
    <div class="shape-title">Hemisphere</div>
    <div class="shape-sub">3D shape (half sphere)</div>
  </div>
  
  <div class="block radius-block">
    <h3>Radius</h3>
    <input type="number" class="value-input" id="valueInput" min="0" step="1" value="9">
    <div class="radius-display" id="radiusDisplay"><i>r</i> = 9</div>
  </div>
  
  <div class="block">
    <h3>Decimal places</h3>
    <div class="dprow" id="dpBtns"></div>
  </div>
  
  <div class="block">
    <h3>Units</h3>
    <div class="btnrow" id="unitBtns"></div>
  </div>
  
  <button class="reveal-btn" id="revealBtn">Reveal</button>
</div>

<div class="main">
  <div class="diagram-area">
    <div class="diagram">
      <svg viewBox="0 0 220 160" aria-label="Hemisphere diagram">
        <defs>
          <linearGradient id="hemiGrad" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" style="stop-color:#f97316;stop-opacity:0.9"/>
            <stop offset="100%" style="stop-color:#dc2626;stop-opacity:0.8"/>
          </linearGradient>
          <marker id="arrow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="5" markerHeight="5" orient="auto">
            <path d="M 0 0 L 10 5 L 0 10 z" fill="#000"/>
          </marker>
        </defs>
        <!-- Hemisphere dome -->
        <path d="M 30 120 A 80 80 0 0 1 190 120" fill="url(#hemiGrad)" stroke="#000" stroke-width="2"/>
        <!-- Base ellipse -->
        <ellipse cx="110" cy="120" rx="80" ry="20" fill="#fee2e2" stroke="#000" stroke-width="2"/>
        <!-- Radius line -->
        <line x1="110" y1="120" x2="185" y2="90" stroke="#000" stroke-width="2" marker-end="url(#arrow)"/>
        <!-- Radius label -->
        <text id="rLabel" x="155" y="85" font-size="16" font-family="Times New Roman" font-style="italic">r</text>
        <!-- Center dot -->
        <circle cx="110" cy="120" r="3" fill="#2563eb"/>
      </svg>
    </div>
    <div class="formulas">
      <div class="f"><i>V</i> = <sup>2</sup>⁄<sub>3</sub>π<i>r</i>³</div>
      <div class="f">CSA = 2π<i>r</i>²</div>
      <div class="f">TSA = 3π<i>r</i>²</div>
    </div>
  </div>

  <div class="calc" id="volumeCalc">
    <h2>(a) Volume</h2>
    <div class="line">Volume = <sup>2</sup>⁄<sub>3</sub>π<i>r</i>³</div>
    <div class="line" id="vS"></div>
    <div class="answer-container">
      <div class="answer-box" id="vE"></div>
    </div>
    <div class="trunc-line" id="vTrunc"></div>
    <div class="answer-container">
      <div class="answer-box" id="vN"></div>
    </div>
  </div>

  <div class="calc" id="csaCalc">
    <h2>(b) Curved Surface Area</h2>
    <div class="line">CSA = 2π<i>r</i>²</div>
    <div class="line" id="csaS"></div>
    <div class="answer-container">
      <div class="answer-box" id="csaE"></div>
    </div>
    <div class="trunc-line" id="csaTrunc"></div>
    <div class="answer-container">
      <div class="answer-box" id="csaN"></div>
    </div>
  </div>

  <div class="calc" id="tsaCalc">
    <h2>(c) Total Surface Area</h2>
    <div class="line">TSA = CSA + π<i>r</i>²</div>
    <div class="line" style="margin-left:28px">= 3π<i>r</i>²</div>
    <div class="line" id="tsaS"></div>
    <div class="answer-container">
      <div class="answer-box" id="tsaE"></div>
    </div>
    <div class="trunc-line" id="tsaTrunc"></div>
    <div class="answer-container">
      <div class="answer-box" id="tsaN"></div>
    </div>
  </div>
</div>

</section>
</div>

<script>
let r = 9;
let dp = 2;
let unit = null;
let answersVisible = false;

const units = [
  {symbol:'', name:'units'},
  {symbol:'mm', name:'millimetre'},
  {symbol:'cm', name:'centimetre'},
  {symbol:'m', name:'metre'},
  {symbol:'km', name:'kilometre'}
];

const valueInput = document.getElementById("valueInput");
const revealBtn = document.getElementById("revealBtn");
const volumeCalc = document.getElementById("volumeCalc");
const csaCalc = document.getElementById("csaCalc");
const tsaCalc = document.getElementById("tsaCalc");

valueInput.addEventListener("input", () => {
  let newValue = parseFloat(valueInput.value);
  if (!isNaN(newValue) && newValue >= 0) {
    r = newValue;
    update();
  }
});

valueInput.addEventListener("change", () => {
  let newValue = parseFloat(valueInput.value);
  if (isNaN(newValue) || newValue < 0) newValue = 9;
  r = newValue;
  valueInput.value = r;
  update();
});

revealBtn.addEventListener("click", () => {
  answersVisible = !answersVisible;
  if (answersVisible) {
    revealBtn.textContent = "Hide";
    volumeCalc.classList.remove("hidden");
    csaCalc.classList.remove("hidden");
    tsaCalc.classList.remove("hidden");
  } else {
    revealBtn.textContent = "Reveal";
    volumeCalc.classList.add("hidden");
    csaCalc.classList.add("hidden");
    tsaCalc.classList.add("hidden");
  }
});

const dpWrap = document.getElementById("dpBtns");
[1,2,3,4].forEach(v => {
  const b = document.createElement("button");
  b.textContent = v;
  if (v === 2) b.classList.add("active");
  b.onclick = () => {
    document.querySelectorAll("#dpBtns button").forEach(x => x.classList.remove("active"));
    b.classList.add("active");
    dp = v;
    update();
  };
  dpWrap.appendChild(b);
});

const unitWrap = document.getElementById("unitBtns");
units.forEach((u, idx) => {
  const b = document.createElement("button");
  b.textContent = u.symbol || 'units';
  b.title = u.name;
  if (idx === 0) b.classList.add("active");
  b.onclick = () => {
    document.querySelectorAll("#unitBtns button").forEach(x => x.classList.remove("active"));
    b.classList.add("active");
    unit = u;
    update();
  };
  unitWrap.appendChild(b);
});

function fmt(n, places) {
  const nearInt = Math.abs(n - Math.round(n)) < 1e-9;
  if (nearInt) return String(Math.round(n));
  return Number(n).toFixed(places);
}

function getTruncatedWithRounding(n, places, unitStr) {
  const truncStr = n.toFixed(places + 1);
  const nextDigit = parseInt(truncStr[truncStr.length - 1], 10);
  const roundUp = nextDigit >= 5;
  const parts = truncStr.split('.');
  const intPart = parts[0];
  const decPart = parts[1];
  const arrow = roundUp ? '<span class="round-arrow round-up">↑</span>' : '<span class="round-arrow round-down">↓</span>';
  return `= ${intPart}.${decPart}…${unitStr} ${arrow}`;
}

function update() {
  const unitStr = unit && unit.symbol ? ' ' + unit.symbol : '';
  const unitStr2 = unit && unit.symbol ? ' ' + unit.symbol + '²' : '';
  const unitStr3 = unit && unit.symbol ? ' ' + unit.symbol + '³' : '';

  const rDisp = Number.isInteger(r) ? r : r.toFixed(2);
  
  document.getElementById("radiusDisplay").innerHTML = `<i>r</i> = ${rDisp}${unitStr}`;
  document.getElementById("rLabel").textContent = "r = " + rDisp;

  // Hemisphere formulas
  const volume = (2/3) * Math.PI * r * r * r;
  const csa = 2 * Math.PI * r * r;
  const tsa = 3 * Math.PI * r * r;

  // Exact coefficients (in terms of π)
  const volCoeff = (2/3) * r * r * r;
  const csaCoeff = 2 * r * r;
  const tsaCoeff = 3 * r * r;

  // Volume
  document.getElementById("vS").innerHTML = `= <sup>2</sup>⁄<sub>3</sub> × π × (${rDisp})³${unitStr3}`;
  document.getElementById("vE").innerHTML = `<span class="label">= </span>${fmt(volCoeff,2)}π${unitStr3} <span class="dp-info">(exact)</span>`;
  document.getElementById("vTrunc").innerHTML = getTruncatedWithRounding(volume, dp, unitStr3);
  document.getElementById("vN").innerHTML = `<span class="label">= </span>${fmt(volume, dp)}${unitStr3} <span class="dp-info">(${dp} dp)</span>`;

  // CSA
  document.getElementById("csaS").innerHTML = `= 2 × π × (${rDisp})²${unitStr2}`;
  document.getElementById("csaE").innerHTML = `<span class="label">= </span>${fmt(csaCoeff,0)}π${unitStr2} <span class="dp-info">(exact)</span>`;
  document.getElementById("csaTrunc").innerHTML = getTruncatedWithRounding(csa, dp, unitStr2);
  document.getElementById("csaN").innerHTML = `<span class="label">= </span>${fmt(csa, dp)}${unitStr2} <span class="dp-info">(${dp} dp)</span>`;

  // TSA
  document.getElementById("tsaS").innerHTML = `= 3 × π × (${rDisp})²${unitStr2}`;
  document.getElementById("tsaE").innerHTML = `<span class="label">= </span>${fmt(tsaCoeff,0)}π${unitStr2} <span class="dp-info">(exact)</span>`;
  document.getElementById("tsaTrunc").innerHTML = getTruncatedWithRounding(tsa, dp, unitStr2);
  document.getElementById("tsaN").innerHTML = `<span class="label">= </span>${fmt(tsa, dp)}${unitStr2} <span class="dp-info">(${dp} dp)</span>`;
}

unit = units[0];
update();
</script>
</body>
</html>
